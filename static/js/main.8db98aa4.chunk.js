(this["webpackJsonpcinema-central"]=this["webpackJsonpcinema-central"]||[]).push([[0],{26:function(e,t,s){},27:function(e,t,s){},37:function(e,t,s){},38:function(e,t,s){},39:function(e,t,s){},40:function(e,t,s){},41:function(e,t,s){},42:function(e,t,s){},43:function(e,t,s){"use strict";s.r(t);var a=s(1),n=s(19),r=s.n(n),c=(s(26),s(15)),i=s(14),o=s(9),l=s(10),h=s(12),u=s(11),d=s(2),j=(s(27),s(7)),m=s(0),g=function(e){var t=e.email,s=e.password,a=e.error,n=e.handleLoginChange,r=e.handleLoginSubmit;return Object(m.jsxs)("form",{children:[a&&Object(m.jsx)("p",{className:"message",children:a}),Object(m.jsx)("p",{className:"message",children:"To login as a guest, simply leave the email and password blank."}),Object(m.jsx)("input",{type:"email",placeholder:"email",name:"email",value:t,onChange:n,required:!0,className:"text-field"}),Object(m.jsx)("input",{type:"password",placeholder:"password",name:"password",value:s,onChange:n,required:!0,className:"text-field"}),Object(m.jsx)(j.b,{to:"/",onClick:r,children:Object(m.jsx)("button",{className:"login-btn",children:"Log In"})})]})},b=(s(37),s.p+"static/media/img_197388.99f9f5f0.png"),p=s.p+"static/media/reel_swell_guy.ea026696.png",v=function(e){var t=e.loggedIn,s=e.handleChangeInSearch,a=e.searchTerms;return Object(m.jsxs)("header",{children:[Object(m.jsx)(j.b,{to:"/",children:Object(m.jsxs)("article",{className:"title-with-logo",children:[Object(m.jsx)("h1",{className:"title",children:"Cinema Central"}),Object(m.jsx)("img",{className:"clippy",src:p,alt:"cartoon film reel mascot"})]})}),t&&Object(m.jsx)("nav",{children:Object(m.jsxs)("span",{className:"search",children:[Object(m.jsx)("img",{className:"search-icon",onClick:function(){return document.querySelector(".search-bar").classList.toggle("active")},src:b,alt:"search icon"}),Object(m.jsx)("input",{onChange:function(e){return s(e)},name:"searchTerms",value:a,className:"search-bar",type:"text",placeholder:"search by movie title..."})]})})]})},f=(s(38),function(e){var t=e.id,s=e.title,a=e.poster_path,n=e.average_rating,r=e.release_date;return Object(m.jsx)(j.b,{to:"/movies/".concat(t),children:Object(m.jsx)("article",{className:"movie-card",style:{backgroundImage:"url(".concat(a,")"),backgroundSize:"contain"},children:Object(m.jsxs)("div",{className:"text-overlay",children:[Object(m.jsx)("h2",{children:s}),Object(m.jsxs)("p",{children:["Average Rating:",Object(m.jsxs)("span",{className:"yellow",children:[" "+n.toFixed(1)," / 10"]})]}),Object(m.jsxs)("p",{children:["Released:",Object(m.jsx)("span",{className:"yellow",children:" "+r})]})]})})})}),O={getUser:function(e,t){var s=this;return fetch("https://rancid-tomatillos.herokuapp.com/api/v2/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return s.checkResponse(e),e.json()}))},getAllMovies:function(){var e=this;return fetch("https://rancid-tomatillos.herokuapp.com/api/v2/movies").then((function(t){return e.checkResponse(t),t.json()})).then((function(e){return e.movies}))},getSingleMovie:function(e){var t=this;return fetch("https://rancid-tomatillos.herokuapp.com/api/v2/movies/".concat(e)).then((function(e){return t.checkResponse(e),e.json()})).then((function(e){return e.movie}))},getSingleMovieVideos:function(e){var t=this;return fetch("https://rancid-tomatillos.herokuapp.com/api/v2/movies/".concat(e,"/videos")).then((function(e){return t.checkResponse(e),e.json()})).then((function(e){return e.videos}))},checkResponse:function(e){if(!e.ok)throw console.log(e),422===e.status||403===e.status?new Error("Sorry, we can't find an account with these credentials. Please try again."):404===e.status?new Error("The page you are looking for doesn't exist"):e.status>=500?new Error("We're having issues on our end. Please try again later."):new Error("Please check your network connection")}},x=(s(39),function(e){Object(h.a)(s,e);var t=Object(u.a)(s);function s(e){var a;return Object(o.a)(this,s),(a=t.call(this,e)).state={allMovies:[],filteredMovies:[],error:"",status:"loading"},a}return Object(l.a)(s,[{key:"componentDidMount",value:function(){var e=this;O.getAllMovies().then((function(t){return e.setState({allMovies:t,error:"",status:"success"})})).catch((function(t){e.setState({error:t.message,status:"error"})}))}},{key:"filterMovies",value:function(){var e=this;return this.state.allMovies.filter((function(t){return-1!==t.title.search(new RegExp(e.props.searchTerms,"i"))}))}},{key:"componentDidUpdate",value:function(){console.log("updated");var e=this.filterMovies();this.state.filteredMovies.length!==e.length&&this.setState({filteredMovies:e})}},{key:"render",value:function(){var e=this.state.status,t=this.state.filteredMovies.map((function(e){return Object(m.jsx)(f,Object(i.a)({},e),e.id)}));return Object(m.jsxs)(m.Fragment,{children:["loading"===e&&Object(m.jsx)("h1",{className:"message",children:"Loading"}),"error"===e&&Object(m.jsx)("h1",{className:"message",children:this.state.error}),"success"===e&&Object(m.jsx)("section",{className:"gallery",children:t})]})}}]),s}(a.Component)),y=(s(40),function(e){var t=e.videoKey;return Object(m.jsx)("iframe",{width:"853",height:"480",src:"https://www.youtube.com/embed/".concat(t),frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",title:"Embedded youtube"},t)}),k=(s(41),s.p+"static/media/placeholder.8f797190.png"),w=function(e){Object(h.a)(s,e);var t=Object(u.a)(s);function s(){var e;Object(o.a)(this,s);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).state={movie:null,videos:null,error:"",status:"loading"},e}return Object(l.a)(s,[{key:"componentDidMount",value:function(){var e=this;Promise.all([O.getSingleMovie(this.props.id),O.getSingleMovieVideos(this.props.id)]).then((function(t){e.setState({movie:t[0],videos:t[1],status:"success",error:""})})).catch((function(t){e.setState({error:t.message,status:"error"})}))}},{key:"formatReleaseDate",value:function(){var e=this.state.movie.release_date;return new Date(e).toLocaleString("en-us",{year:"numeric",month:"long",day:"numeric"})}},{key:"formatGenres",value:function(){return this.state.movie.genres.join("/")}},{key:"render",value:function(){var e=this.state.status,t=this.state,s=t.movie,a=t.videos;return Object(m.jsxs)(m.Fragment,{children:["loading"===e&&Object(m.jsx)("h1",{className:"message",children:"Loading"}),"error"===e&&Object(m.jsx)("h1",{className:"message",children:this.state.error}),"success"===e&&this.state.movie&&Object(m.jsxs)("section",{className:"details-container",children:[Object(m.jsx)(y,{videoKey:a[a.length-1].key}),Object(m.jsx)("section",{className:"details",style:{backgroundImage:"url(".concat(s.backdrop_path?s.backdrop_path:k,")")},children:Object(m.jsxs)("article",{className:"details-wrapper",children:[Object(m.jsxs)("div",{className:"heading",children:[Object(m.jsxs)("h2",{children:[s.title," (",this.formatReleaseDate(),")"]}),s.tagline&&Object(m.jsx)("h3",{children:"".concat(s.tagline)})]}),Object(m.jsx)("p",{className:"overview",children:s.overview}),Object(m.jsxs)("h4",{children:[this.formatGenres()," - ",s.runtime," minutes - ",s.average_rating.toFixed(1)," / 10"]}),Object(m.jsx)(j.b,{to:"/",children:Object(m.jsx)("button",{children:"Home"})})]})})]})]})}}]),s}(a.Component),S=w,N=(s(42),function(e){Object(h.a)(s,e);var t=Object(u.a)(s);function s(){var e;Object(o.a)(this,s);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).state={credentials:{email:"sam@turing.io",password:"123456"},user:{name:"",id:0},searchTerms:"",error:"",status:"loading"},e.handleChangeInSearch=function(t){e.setState({searchTerms:t.target.value})},e.handleLoginChange=function(t){var s=e.state.credentials,a=t.target,n=a.name,r=a.value;e.setState({credentials:Object(i.a)(Object(i.a)({},s),{},Object(c.a)({},n,r))})},e.handleLoginSubmit=function(t){t.preventDefault();var s=e.state.credentials,a=s.email,n=s.password;O.getUser(a,n).then((function(t){var s=t.user,a=s.id,n=s.name;e.setState({user:{id:a,name:n},error:"",status:"success"}),localStorage.setItem("user",JSON.stringify(e.state.user))})).catch((function(t){e.setState({error:t.message,status:"error"})}))},e}return Object(l.a)(s,[{key:"componentDidMount",value:function(){localStorage.getItem("user")&&this.setState({user:{name:JSON.parse(localStorage.getItem("user")).name,id:JSON.parse(localStorage.getItem("user")).id},error:"",status:"success"})}},{key:"render",value:function(){var e=this;return Object(m.jsxs)(m.Fragment,{children:[this.state.user.id?Object(m.jsx)(d.a,{to:"/"}):Object(m.jsx)(d.a,{to:"/login"}),Object(m.jsx)(v,{loggedIn:!!this.state.user.id,handleChangeInSearch:this.handleChangeInSearch,searchTerms:this.state.searchTerms}),Object(m.jsx)("main",{children:Object(m.jsxs)(d.d,{children:[Object(m.jsx)(d.b,{exact:!0,path:"/login",render:function(){return Object(m.jsx)(g,{data:e.state.credentials,error:e.state.error,handleLoginChange:e.handleLoginChange,handleLoginSubmit:e.handleLoginSubmit})}}),Object(m.jsx)(d.b,{exact:!0,path:"/",render:function(){return e.state.user.id?Object(m.jsx)(x,{searchTerms:e.state.searchTerms}):Object(m.jsx)(d.a,{to:"/login"})}}),Object(m.jsx)(d.b,{path:"/movies/:id",render:function(t){var s=t.match;return e.state.user.id?Object(m.jsx)(S,{id:s.params.id}):Object(m.jsx)(d.a,{to:"/login"})}}),Object(m.jsx)(d.b,{path:"*",children:Object(m.jsx)("p",{children:"The page you are looking for doesn't exist"})})]})}),Object(m.jsx)("footer",{children:Object(m.jsx)("h5",{children:"\xa9 2021"})})]})}}]),s}(a.Component)),C=N;r.a.render(Object(m.jsx)(j.a,{children:Object(m.jsx)(C,{})}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.8db98aa4.chunk.js.map